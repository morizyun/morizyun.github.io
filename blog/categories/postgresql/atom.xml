<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: PostgreSQL | 酒と泪とRubyとRailsと]]></title>
  <link href="http://morizyun.github.io/blog/categories/postgresql/atom.xml" rel="self"/>
  <link href="http://morizyun.github.io/"/>
  <updated>2016-02-08T22:04:42+09:00</updated>
  <id>http://morizyun.github.io/</id>
  <author>
    <name><![CDATA[morizyun]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Webエンジニアにも勉強になる！データベースエンジニア養成読本[書評]]]></title>
    <link href="http://morizyun.github.io/blog/database-engineer-training-book-review/"/>
    <updated>2015-03-07T16:00:00+09:00</updated>
    <id>http://morizyun.github.io/blog/database-engineer-training-book-review</id>
    <content type="html"><![CDATA[<p><a href="http://www.amazon.co.jp/gp/product/4774158062/ref=as_li_qf_sp_asin_il?ie=UTF8&camp=247&creative=1211&creativeASIN=4774158062&linkCode=as2&tag=morizyun00-22"><img border="0" src="http://ws.assoc-amazon.jp/widgets/q?_encoding=UTF8&ASIN=4774158062&Format=_SL160_&ID=AsinImage&MarketPlace=JP&ServiceVersion=20070822&WS=1&tag=morizyun00-22" width="150" style="float: left; margin: 0 20px 20px 0;" ></a><img src="http://www.assoc-amazon.jp/e/ir?t=morizyun00-22&l=as2&o=9&a=4774158062" width="1" height="1" border="0" alt="" style="border:none !important; margin:0px !important;" />
最近、仕事でRMSDBやNoSQL関係の設計などで苦労をしていたので、基礎知識の復習を兼ねて『<strong><a href="http://www.amazon.co.jp/gp/product/4774158062/ref=as_li_qf_sp_asin_il?ie=UTF8&amp;camp=247&amp;creative=1211&amp;creativeASIN=4774158062&amp;linkCode=as2&amp;tag=morizyun00-22">データベースエンジニア養成読本</a></strong>』を読みました。全般的にRMSDBやNoSQLの主要な製品の概要やSQLなどの基礎知識を体系的に知ることができる本です。</p>

<p>今回はいつもどおり、自分の頭を整理するための俺得メモです。
(わかりにくい部分が多いと思いますが、ご容赦ください)</p>

<!-- more -->


<br style="clear:both;"/>


<p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- square -->
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-4186413323075068" data-ad-slot="5059873392"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>

<h2>DBの需要な機能</h2>

<p>DBが一般的に持っているトランザクションのACID属性はアプリケーションの実装を楽にするために重要な機能である。</p>

<pre>
Atomicity   (原子性) => トランザクションに含まれるタスクが全て実行、or 全く実行されないことを保証する性質
Consistency (一貫性) => トランザクション開始と終了時にあらかじめ与えられた整合性を満たすことを保証する性質
Isolation   (独立性) => トランザクション中に行われる操作の過程が他の操作から隠蔽されること
Durability  (永続性) => トランザクション操作の完了通知をユーザが受けた時点で、その操作は永続的となり、結果が失われないこと
</pre>


<p>上記の説明は、<strong><a href="http://ja.wikipedia.org/wiki/ACID_(%E3%82%B3%E3%83%B3%E3%83%94%E3%83%A5%E3%83%BC%E3%82%BF%E7%A7%91%E5%AD%A6">ACID (コンピュータ科学) Wikipedia</a>)</strong></p>

<h2>InnoDB、MyISAMとは</h2>

<p>MySQLのデータベースエンジン「InnoDB と MyISAM」について。</p>

<pre>
InnoDB => ロック方式が行ロック
MyISAM => ロック方式がテーブルロック。テーブル自体にロックがかかるため、重い処理を実行すると処理待ちが発生しやすくなる。
</pre>


<h2>NoSQLの特徴</h2>

<p>Web系システムを中心として次の「3V」と呼ばれる課題が発生しやすくなった。</p>

<pre>
Volume   => データ量
Variety  => データの種類
Velocity => データ発生 / 処理頻度 / 速度
</pre>


<p>その課題に特化した解決策として、NoSQLが台頭し始めた。</p>

<p>しかしながら、NoSQLがRDBMSに置き換わるようなものではない。理由としては、</p>

<pre>
1) NoSQLは特定の問題を解決するためにRDBMSの持ついくつかの機能を犠牲にしている
2) NoSQLは歴史が浅く、技術として十分に使い古されておらず、ノウハウも不足している
</pre>


<h2>カラムファミリー型のデータベース: BigTableなど</h2>

<p>複数の列をまとめたカラムファミリーの単位でデータを取り出す。
実際のデータは、行、カラムファミリー、列をキーとしてそれらを辞書順にソートされたKVSのような形でデータを保持している。</p>

<p>カラムファミリー型DBの得意分野は、当単位での入力・検索を高速に行うようなOLTP(OnLine Transaction Processing)
である。一方で、RDBMSは格納データに複雑な集計を行う計算などに向いている。使い方が全く異なることに注意が必要。</p>

<h2>Redisについて</h2>

<p>すべてのデータをメモリ上に持つ「インメモリデータベース」として、高速に動作。メモリ上のデータをディスクに保存し、永続化する。</p>

<p>Redisは次のデータ型を持つ。</p>

<pre>
String:     文字列
List:       配列
Set:        集合
Hash:       連想配列
Sorted Set: スコア付き集合
</pre>


<p>Redisはシングルプロセス、シングルスレッドのイベント駆動アーキテクチャを採用しているので多くの処理をアトミックに行える。</p>

<p>Redisが有効な用途の一例。</p>

<pre>
リアルタイムランキング => Sorted Set型を使用すると高速にランキング処理を行うことができる
アクティブユーザーの集計 => Set型を利用して、集合操作関数を利用すればいろいろなデータを取得できる
</pre>


<h2>Riakについて</h2>

<p>Riakの特徴は次の通り。</p>

<pre>
高可用性) 多少のハードウェアやネットワークの故障でシステムが停止することなく、どんなときも書き込みと読み出しができる
高信頼性) 多少の負荷でもシステムは安定したレスポンスとスループットを提供する
拡張性) データ量や負荷に応じて、無停止でシステムをスケールアウトさせることができる
低遅延) どんなときでも、ユーザーを待たせず、すぐにレスポンスを得ることができる
予測可能性) 性能予測を裏切らない、安定したスケールアウト性
</pre>


<p>Riakを利用すべきシーン。</p>

<pre>
・データ量が数倍のレベルで増減する
・簡単にスケールアウトしたい
・複数行のトランザクションやJOINがない
・スパイク時でも安定したレイテンシが欲しい
・故障時の運用を簡単にしたい
・アインしんして夜に眠りたい
</pre>


<p>ちなみに、GitHub Pagesの静的ファイルはすべてRiak上に保存されている。</p>

<h2>SQLの基礎</h2>

<p>SQLの種類。</p>

<pre>
データ操作言語(DML: Data Manipulation Language) select/insert/update/deleteなど
データ定義言語(DDL: Data Definition Language) テーブル作成やフィールのデータ型の変更など
データ制御言語(DCL: Data Control Language) ユーザーの作成や権限の設定、排他制御の管理など
</pre>




<br style="clear:both;"/>


<p><script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- square -->
<ins class="adsbygoogle" style="display:inline-block;width:336px;height:280px" data-ad-client="ca-pub-4186413323075068" data-ad-slot="5059873392"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[HerokuにRails 3.2.9/Bootstrapでデプロイ 最短・簡単ガイドだよ！]]></title>
    <link href="http://morizyun.github.io/blog/heroku-rails-postgresql/"/>
    <updated>2012-11-25T14:00:00+09:00</updated>
    <id>http://morizyun.github.io/blog/heroku-rails-postgresql</id>
    <content type="html"><![CDATA[<p>Heroku + Rails 3.2.9 + Bootstrap + Haml + PostgreSQL でデプロイするまでの最短ガイドを作りました！</p>

<p><a href="http://morizyun.github.io/blog/heroku-rails-postgresql" title="fpu_tmp_1353848330.5039_237fab by morizyun, on Flickr"><img src="http://farm9.staticflickr.com/8066/8216074991_1f11f3eda7_z.jpg" width="640" height="234" alt="fpu_tmp_1353848330.5039_237fab"></a></p>

<!-- more -->


<h2>Heroku ユーザー登録</h2>

<p><a href="http://heroku.com">Heroku</a>でユーザー登録をします。
アカウント作成時に使ったメールアドレスとパスワードは後で使うのでメモっておいてください。</p>

<p><a href="http://heroku.com/" title="fpu_tmp_1353828845.2153_57ac05 by morizyun, on Flickr"><img src="http://farm9.staticflickr.com/8482/8216564804_23e4f2f0e6.jpg" width="500" height="233" alt="fpu_tmp_1353828845.2153_57ac05"></a></p>

<p><a href="https://toolbelt.heroku.com/">Heroku Toolbelt</a>をインストールします。Heroku Toolbeltの機能は；</p>

<ul>
<li>Heroku client - Heroku appsを管理するためのCLI</li>
<li>Foreman - ローカルでHerokuアップを動かすためのオプション</li>
<li>Git - HerokuへのPush/ソースのバージョン管理</li>
</ul>


<p><a href="https://toolbelt.heroku.com/" title="fpu_tmp_1353829261.6919_09c68e by morizyun, on Flickr"><img src="http://farm9.staticflickr.com/8206/8216575530_03e6a52a70.jpg" width="500" height="291" alt="fpu_tmp_1353829261.6919_09c68e"></a></p>

<h2>ローカル環境設定</h2>

<p>任意でrailsのアップデートを実行します。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rvmsudo gem update rails
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>gem herokuをインストールします。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>gem install <span class="s1">&#39;heroku&#39;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>アカウント作成時に使ったメールアドレスとパスワードを事前に設定します。
これによってデプロイのたびに、パスワードを聞かれるのを防ぎます。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">heroku</span> <span class="n">keys</span><span class="ss">:add</span>
</span><span class='line'><span class="no">Enter</span> <span class="n">your</span> <span class="no">Heroku</span> <span class="n">credentials</span><span class="o">.</span>
</span><span class='line'><span class="no">Email</span><span class="p">:</span> <span class="n">email</span><span class="vi">@example</span><span class="o">.</span><span class="n">com</span>
</span><span class='line'><span class="no">Password</span><span class="p">:</span> <span class="n">your</span><span class="o">-</span><span class="n">password</span>
</span><span class='line'><span class="no">Uploading</span> <span class="n">ssh</span> <span class="kp">public</span> <span class="n">key</span> <span class="sr">/Users/</span><span class="n">joe</span><span class="o">/.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="o">.</span><span class="n">pub</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>Rails プロジェクト作成 〜 index.html表示まで</h2>

<p>Railsの新規プロジェクトを作成します。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails new <span class="nb">test</span>-app --skip-test-unit -d postgresql
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Gitリポジトリ作成を作成します。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>git init
</span><span class='line'>git add -A
</span><span class='line'>git commit -m <span class="s2">&quot;create new project&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>herokuコマンドを使って、heroku上にアプリケーションを作成します。
(test-appだとすでに使われてて動かないので、使われてなさそうな名前がいいっすよ〜)</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>heroku create <span class="nb">test</span>-app --stack cedar&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;blockquote&gt;&lt;p&gt;Creating <span class="nb">test</span>-app... <span class="k">done</span>, stack is cedar
</span><span class='line'>http://test-app.herokuapp.com/ | git@heroku.com:test-app.git
</span><span class='line'>Git remote heroku added <span class="c"># &amp;lt;= こうなっていれば成功</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p></blockquote>

<p>http://test-app.herokuapp.com/ をブラウザで表示されることを確認。</p>

<h2>Rails Gem登録 〜 scaffold表示まで</h2>

<p>gemfileを編集して、プロジェクトに任意のGemを追加。
(gemは適宜カスタマイズしてください)</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>gemfile  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">source</span> <span class="s1">&#39;https://rubygems.org&#39;</span>
</span><span class='line'>ruby <span class="s2">&quot;1.9.3&quot;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;rails&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Bootstrap&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;less-rails&#39;</span>
</span><span class='line'>gem <span class="s1">&#39;less-rails-bootstrap&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Form Builders&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;simple_form&#39;</span>
</span><span class='line'>gem <span class="s1">&#39;country_select&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Haml&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;haml-rails&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;jQuery/json&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;jquery-rails&#39;</span>
</span><span class='line'>gem <span class="s1">&#39;jquery-cookie-rails&#39;</span> <span class="c"># jquery-cookie</span>
</span><span class='line'>gem <span class="s1">&#39;json&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Presenter&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;draper&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Thin&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;thin&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;group :assets <span class="k">do</span>
</span><span class='line'><span class="k">  </span>gem <span class="s1">&#39;coffee-rails&#39;</span>
</span><span class='line'>  gem <span class="s1">&#39;therubyracer&#39;</span>
</span><span class='line'>  gem <span class="s1">&#39;uglifier&#39;</span>
</span><span class='line'>end&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;group :development <span class="k">do</span>
</span><span class='line'>  <span class="c"># 環境変数をロードして複数のプロセスを実行する作業を自動化</span>
</span><span class='line'>  gem <span class="s1">&#39;foreman&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># viewやcssの変更を監視してブラウザを自動的にリロードする</span>
</span><span class='line'>  gem <span class="s1">&#39;guard-livereload&#39;</span>
</span><span class='line'>  gem <span class="s1">&#39;em-websocket&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># デバッガー</span>
</span><span class='line'>  gem <span class="s1">&#39;pry-rails&#39;</span>
</span><span class='line'>end&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;group :development, :test <span class="k">do</span>
</span><span class='line'><span class="k">  </span>gem <span class="s1">&#39;mysql2&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># Rspec</span>
</span><span class='line'>  gem <span class="s1">&#39;rspec-rails&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># FactoryGirl</span>
</span><span class='line'>  gem <span class="s1">&#39;factory_girl_rails&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># 設定をロードしたサーバーによってテストを高速化</span>
</span><span class='line'>  gem <span class="s1">&#39;spork&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># ファイルの変更を検知する。OSX用</span>
</span><span class='line'>  gem <span class="s1">&#39;rb-fsevent&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># テスト結果をGrowlで通知する</span>
</span><span class='line'>  gem <span class="s1">&#39;growl&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># ファイルの変更を監視してテストを自動化</span>
</span><span class='line'>  gem <span class="s1">&#39;guard-rspec&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># 設定ファイルの変更を監視してテストサーバーを再起動</span>
</span><span class='line'>  gem <span class="s1">&#39;guard-spork&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  gem <span class="s1">&#39;rails3-generators&#39;</span>, :git <span class="o">=</span>&gt; <span class="s1">&#39;https://github.com/neocoin/rails3-generators.git&#39;</span>
</span><span class='line'>end&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;group :postgres <span class="k">do</span>
</span><span class='line'><span class="k">  </span>gem <span class="s1">&#39;pg&#39;</span>
</span><span class='line'>end
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Gemをインストール。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bundle install
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>config/application.rbの設定です。<br/>(class Application &lt; Rails::Application内に追記してください)</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>config/application.rb  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;LESS&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="n">config</span><span class="o">.</span><span class="n">app_generators</span><span class="o">.</span><span class="n">stylesheet_engine</span> <span class="ss">:less</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">less</span><span class="o">.</span><span class="n">paths</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="si">}</span><span class="s2">/lib/less/protractor/stylesheets&quot;</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">less</span><span class="o">.</span><span class="n">compress</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">compress</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">initialize_on_precompile</span><span class="o">=</span><span class="kp">false</span> <span class="c1"># herokuでasset:precomileエラー対策&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="no">Set</span> <span class="n">timezone</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;config.time_zone = &#39;Tokyo&#39;</span>
</span><span class='line'><span class="sr">config.active_record.default_timezone = :local&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="err">日本語化</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;config.i18n.default_locale = :ja&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">generator</span><span class="err">の設定</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;config.generators do |g|</span>
</span><span class='line'><span class="sr">  g.orm :active_record</span>
</span><span class='line'><span class="sr">  g.template_engine :haml</span>
</span><span class='line'><span class="sr">  g.test_framework  :rspec, :fixture =&gt; true</span>
</span><span class='line'><span class="sr">  g.fixture_replacement :factory_girl, :dir =&gt; &quot;spec/</span><span class="n">factories</span><span class="s2">&quot;</span>
</span><span class='line'><span class="s2">end&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;h1&gt;load original validator(オリジナルのバリデーターがある場合のみ)&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;config.autoload_paths += %W(</span><span class="si">#{</span><span class="n">config</span><span class="o">.</span><span class="n">root</span><span class="si">}</span><span class="s2">/lib/validators)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Herokuのタイムゾーン設定。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>heroku config:add <span class="nv">TZ</span><span class="o">=</span>Asia/Tokyo
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>application.cssを削除して、lessファイルを生成</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nt">rm</span> <span class="nt">-rf</span> <span class="nt">app</span><span class="o">/</span><span class="nt">assets</span><span class="o">/</span><span class="nt">stylesheets</span><span class="o">/</span><span class="nt">application</span><span class="nc">.css</span>
</span><span class='line'><span class="nt">rails</span> <span class="nt">generate</span> <span class="nt">less</span><span class="nd">:assets</span> <span class="nt">application</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>bootstrapのcssを読み込むように設定を追加する。
app/assets/stylesheets/application.css.lessに以下んコードを追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/assets/stylesheets/application.css.less  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="sr">//</span> <span class="o">=</span> <span class="n">require_tree</span> <span class="o">.</span>
</span><span class='line'><span class="vi">@import</span> <span class="s2">&quot;twitter/bootstrap&quot;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>bootstrapのjavascriptを読み込むようにするために、app/assets/javascripts/application.jsに以下のコードを追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/assets/javascripts/application.js  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="sr">//</span><span class="o">=</span> <span class="nb">require</span> <span class="n">twitter</span><span class="o">/</span><span class="n">bootstrap</span>
</span><span class='line'><span class="sr">//</span><span class="o">=</span> <span class="nb">require</span> <span class="n">jquery</span><span class="o">.</span><span class="n">cookie</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;$(document).ready(function(){&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>application.html.erbファイルをhamlにファイル名を変更。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mv app/views/layouts/application.html.erb app/views/layouts/application.html.haml
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>application.html.hamlの中身もhaml形式にする。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>application.html.haml  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="nn">!!! 5</span>
</span><span class='line'><span class="nt">%html</span>
</span><span class='line'>  <span class="nt">%head</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;%title TEST_APP
</span><span class='line'><span class="p">=</span> <span class="n">stylesheet_link_tag</span> <span class="s2">&quot;application&quot;</span><span class="p">,</span> <span class="ss">:media</span> <span class="o">=&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="s2">&quot;all&quot;</span>
</span><span class='line'><span class="p">=</span> <span class="n">javascript_include_tag</span> <span class="s2">&quot;application&quot;</span>
</span><span class='line'><span class="p">=</span> <span class="n">csrf_meta_tags</span>
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  %body&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;= yield
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Railsの日本語化ファイルを設定する。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>wget https://raw.github.com/svenfuchs/rails-i18n/master/rails/locale/ja.yml
</span><span class='line'>mv ja.yml config/locales/ja.yml
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>simple formの初期設定(bootstrap対応)</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails generate simple_form:install --bootstrap
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>railsへのrspecのインストールと雛形を作成</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails generate rspec:install
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>rspecの設定ファイル"spec/spec_helper.rb"を修正(コメントアウトする)</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>spec/spec_helper.rb  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;config.fixture_path = &quot;</span><span class="si">#{</span><span class="o">::</span><span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="si">}</span><span class="sr">/s</span><span class="n">pec</span><span class="o">/</span><span class="n">fixtures</span><span class="s2">&quot;&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;h1&gt;config.use_transactional_fixtures = true&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>scaffoldを追加の前にpublic/index.htmlをリネーム(無効化する)。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mv public/index.html public/_____index.html
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>scaffoldの作成してビューを追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">scaffold</span> <span class="n">product</span> <span class="nb">name</span> <span class="n">price</span><span class="ss">:integer</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>config/routes.rbにて、ルートアクセス設定を追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>config/routes.rb  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">root</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="s2">&quot;products#index&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Herokuでthinが動くようにする。
プロジェクト直下にProcfileを新規作成。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>Procfile  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>web: bundle <span class="nb">exec </span>rails server thin -p <span class="nv">$PORT</span> -e <span class="nv">$RACK_ENV</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>設定画反映されたかチェック。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>foreman check&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;blockquote&gt;&lt;p&gt;valid procfile detected <span class="o">(</span>web<span class="o">)</span> ← 成功
</span></code></pre></td></tr></table></div></figure></notextile></div></p></blockquote>

<p>$RACK_ENVをセットするファイルを作成
<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">echo</span> <span class="s2">&quot;RACK_ENV=development&quot;</span> &gt;&gt;.env
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>gitに.envが記録されないようにする。
プロジェクト直下の.gitignoreに以下を追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>.gitignore  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>.env
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Herokuへのアプリのデプロイ => DBのマイグレーション。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">git</span> <span class="n">add</span> <span class="o">.</span> <span class="o">-</span><span class="n">A</span>
</span><span class='line'><span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;add scafford&quot;</span>
</span><span class='line'><span class="n">git</span> <span class="n">push</span> <span class="n">heroku</span> <span class="n">master</span>
</span><span class='line'><span class="n">heroku</span> <span class="n">run</span> <span class="n">rake</span> <span class="n">db</span><span class="ss">:migrate</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>ブラウザでscaffordしたビューが見れることを確認。
デプロイまでの最短ガイドは以上っす。</p>

<p>Thank very much you for your kind attention.</p>

<h2>関連記事</h2>

<p><strong><a href="/blog/pow-guard-rails">開発サーバをThinからPowに切り替えて開発効率アップ！ (Mac限定)</a></strong> にてPowに関する記事を載せました。Guardが更に活用できると思います。よかったらぜひ見てください。</p>

<h2>補足 : ローカルでのテスト環境の構築</h2>

<p>config/database.ymlを以下の通り編集する。今回は</p>

<ul>
<li>"development", "test" => mysql</li>
<li>"production" => postgreSQL</li>
</ul>


<p>とした場合の設定です。環境に合わせて調整を。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>config/database.yml  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">development</span><span class="p">:</span>
</span><span class='line'>  <span class="n">adapter</span><span class="p">:</span> <span class="n">mysql2</span>
</span><span class='line'>  <span class="n">encoding</span><span class="p">:</span> <span class="n">utf8</span>
</span><span class='line'>  <span class="n">reconnect</span><span class="p">:</span> <span class="kp">false</span>
</span><span class='line'>  <span class="n">database</span><span class="p">:</span> <span class="nb">test</span><span class="o">-</span><span class="n">app_development</span>
</span><span class='line'>  <span class="n">pool</span><span class="p">:</span> <span class="mi">5</span>
</span><span class='line'>  <span class="n">username</span><span class="p">:</span> <span class="n">root</span>
</span><span class='line'>  <span class="n">password</span><span class="p">:</span>
</span><span class='line'>  <span class="n">socket</span><span class="p">:</span> <span class="sr">/var/</span><span class="n">lib</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">mysql</span><span class="o">.</span><span class="n">sock</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;test:</span>
</span><span class='line'><span class="sr">  adapter: mysql2</span>
</span><span class='line'><span class="sr">  encoding: utf8</span>
</span><span class='line'><span class="sr">  reconnect: false</span>
</span><span class='line'><span class="sr">  database: test-app_test</span>
</span><span class='line'><span class="sr">  pool: 5</span>
</span><span class='line'><span class="sr">  username: root</span>
</span><span class='line'><span class="sr">  password:</span>
</span><span class='line'><span class="sr">  socket: /</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">mysql</span><span class="o">.</span><span class="n">sock</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;production:</span>
</span><span class='line'><span class="sr">  adapter: postgresql</span>
</span><span class='line'><span class="sr">  encoding: unicode</span>
</span><span class='line'><span class="sr">  database: test-app_production</span>
</span><span class='line'><span class="sr">  pool: 5</span>
</span><span class='line'><span class="sr">  username:</span>
</span><span class='line'><span class="sr">  password:</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>DBの作成を実行。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rake db:create <span class="nv">RAILES_ENV</span><span class="o">=</span><span class="s1">&#39;development&#39;</span>
</span><span class='line'>rake db:create <span class="nv">RAILES_ENV</span><span class="o">=</span><span class="s1">&#39;test&#39;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>サーバプロセスを起動する。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>foreman start
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>http://0.0.0.0:5000/_____index.htmlを表示してDBに接続されていることを確認する。</p>

<h2>補足 : コマンド系</h2>

<p>Heroku コマンド一覧</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;herokuへのログイン&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku login
</span><span class='line'>Email: email@example.com
</span><span class='line'>Password: your-password&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;アプリの作成&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku create&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;マイグレーション&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku run rake db:migrate&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;アプリのデプロイ&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;git add . -A
</span><span class='line'>git commit -m <span class="s2">&quot;add function&quot;</span>
</span><span class='line'>git push heroku master&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;環境変数のセット&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku config:add <span class="nv">USERNAME</span><span class="o">=</span>admin <span class="nv">PASSWORD</span><span class="o">=</span>xxx&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;ログ確認&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku logs -t&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;heroku プロセス情報の表示&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku ps&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;heroku 環境変数の表示&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku config
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>既存モデルのRspec雛形を作成するコマンド。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails generate rspec:model products
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>テスト環境は以下の通りです。</p>

<pre>
OS : Mac Lion(OS X 10.7)
Rails : 3.2.9
haml : 3.1.7
coffee-script : 3.2.1
</pre>


<h2>Special Thanks</h2>

<ul>
<li><p><a href="http://nobyu.hatenadiary.jp/entry/20100207/1265531331">HerokuとRailsで手早くWebサイトを作る</a></p></li>
<li><p><a href="http://change-the-world.heroku.com/5">Railsアプリ作成 + Herokuデプロイ</a></p></li>
<li><p><a href="http://ovreneli.blogspot.jp/2012/06/railspostgresqlheroku.html">RailsアプリをPostgreSQLで開発してHerokuにデプロイするまでの簡単まとめ</a></p></li>
<li><p><a href="http://edywrite.blogspot.jp/2012/08/herokuwebthin.html">Herokuのwebサーバをthinに変更する</a></p></li>
</ul>

]]></content>
  </entry>
  
</feed>
