<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Haml | 酒と泪とRubyとRailsと]]></title>
  <link href="http://morizyun.github.io/blog/categories/haml/atom.xml" rel="self"/>
  <link href="http://morizyun.github.io/"/>
  <updated>2015-07-20T14:03:56+09:00</updated>
  <id>http://morizyun.github.io/</id>
  <author>
    <name><![CDATA[morizyun]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Rails 3.2.13/Bootstrap/Haml プロジェクト新規作成 最短ガイドだよ！]]></title>
    <link href="http://morizyun.github.io/blog/rails-mysql-bootstrap/"/>
    <updated>2012-11-26T08:00:00+09:00</updated>
    <id>http://morizyun.github.io/blog/rails-mysql-bootstrap</id>
    <content type="html"><![CDATA[<p><div>
  <script type="text/javascript"><!--
  google_ad_client = "ca-pub-4186413323075068";
  /* bottom_burner */
  google_ad_slot = "2184590598";
  google_ad_width = 468;
  google_ad_height = 15;
  //-->
  </script>
  <script type="text/javascript"
          src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
  </script>
</div>
Rails 3.2.13 + Bootstrap + Hamlのプロジェクト作成のフローを作成しました。</p>

<p><a href="http://morizyun.github.io/blog/rails-mysql-bootstrap" title="fpu_tmp_1353848330.5039_237fab by morizyun, on Flickr"><img src="http://farm9.staticflickr.com/8346/8219161728_66b992a1bd.jpg" width="500" alt="fpu_tmp_1353848330.5039_237fab"></a></p>

<!-- more -->


<h2>Rails プロジェクト作成 〜 index.html確認まで</h2>

<p>Railsの新規プロジェクトを作成。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails new <span class="nb">test</span>-app -d mysql --skip-test-unit --skip-bundle
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>RVMを使っている場合は、プロジェクト直下で.rvmrcを作成する。<br/></p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd test</span>-app/
</span><span class='line'><span class="nb">echo </span>ruby-1.9.3-p327 &gt; .ruby-version
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Rails用の<code>.gitignore</code>を作成します。<code>.gitignore</code>を生成するgitignore-boilerplatesを使う場合はこちら。(Macでのインストール方法は、<code>brew install gibo</code>を実行)</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Mac/RubyMineを使う場合の例です、gibo --listで確認して下さい&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gibo OSX Ruby Rails RubyMine IntelliJ &gt; .gitignore
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>GitHubから<code>.gitignore</code>のテンプレートをダウンロードする場合はこちら。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>wget https://raw.github.com/github/gitignore/master/Rails.gitignore;mv Rails.gitignore .gitignore
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Gitリポジトリ作成を作成します。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>git init
</span><span class='line'>git add -A
</span><span class='line'>git commit -m <span class="s2">&quot;new project&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><code>Gemfile</code>を編集して、<code>bundle install</code>でGemをインストール。<br/>
(gemは適宜カスタマイズしてください)</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">source</span> <span class="s1">&#39;https://rubygems.org&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;rails&#39;</span>
</span><span class='line'>gem <span class="s1">&#39;rake&#39;</span> <span class="c"># 本番rake実行時に必要だった&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Bootstrap&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;less-rails&#39;</span>
</span><span class='line'>gem <span class="s1">&#39;twitter-bootstrap-rails&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Compress/Sassy-Buttons/Zurui-design&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;sass-rails&#39;</span>
</span><span class='line'>gem <span class="s1">&#39;compass-colors&#39;</span>
</span><span class='line'>gem <span class="s1">&#39;compass-rails&#39;</span>
</span><span class='line'>gem <span class="s1">&#39;sassy-buttons&#39;</span>
</span><span class='line'>gem <span class="s1">&#39;zurui-sass-rails&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Font Awesome&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;font-awesome-rails&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Form Builders&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;simple_form&#39;</span>
</span><span class='line'>gem <span class="s1">&#39;country_select&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Haml&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;haml-rails&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;jQuery/json&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;jquery-rails&#39;</span>
</span><span class='line'>gem <span class="s1">&#39;jquery-cookie-rails&#39;</span> <span class="c"># jquery-cookie</span>
</span><span class='line'>gem <span class="s1">&#39;json&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;MySQL&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;mysql2&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Presenter&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;active_decorator&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;定数管理&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;rails_config&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;スクレイピング&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;nokogiri&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Seed管理&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;seed-fu&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;asset取得系のログを出力しない&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;quiet_assets&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;group :assets <span class="k">do</span>
</span><span class='line'><span class="k">  </span>gem <span class="s1">&#39;coffee-rails&#39;</span>
</span><span class='line'>  gem <span class="s1">&#39;therubyracer&#39;</span>, <span class="s2">&quot;~&gt; 0.10.2&quot;</span>
</span><span class='line'>  gem <span class="s1">&#39;uglifier&#39;</span>
</span><span class='line'>  gem <span class="s1">&#39;libv8&#39;</span>, <span class="s1">&#39;~&gt; 3.3.10&#39;</span>
</span><span class='line'>end&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;group :development <span class="k">do</span>
</span><span class='line'>  <span class="c"># ドキュメント生成</span>
</span><span class='line'>  gem <span class="s1">&#39;yard&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># erbからhamlに変換</span>
</span><span class='line'>  gem <span class="s1">&#39;erb2haml&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># エラー画面をわかりやすく整形してくれる</span>
</span><span class='line'>  gem <span class="s1">&#39;better_errors&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># better_errorsの画面上にirb/pry(PERL)を表示する</span>
</span><span class='line'>  gem <span class="s1">&#39;binding_of_caller&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># フッターにデバック情報を表示</span>
</span><span class='line'>  gem <span class="s1">&#39;rails-footnotes&#39;</span>, <span class="s1">&#39;&gt;= 3.7.9&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># N+1問題の警告を出力</span>
</span><span class='line'>  gem <span class="s2">&quot;bullet&quot;</span>
</span><span class='line'>end&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;group :development, :test <span class="k">do</span>
</span><span class='line'>  <span class="c"># Pow (Mac用のサーバです。Mac以外 or Pow以外のサーバ利用の方は不要)</span>
</span><span class='line'>  gem <span class="s1">&#39;pow&#39;</span>
</span><span class='line'>  gem <span class="s1">&#39;rails3-generators&#39;</span>
</span><span class='line'>end&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;powder&#39;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><code>config/application.rb</code>の中にある<code>YourAppName::Application.configure</code>内に以下を追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;Set timezone&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="n">config</span><span class="o">.</span><span class="n">time_zone</span> <span class="o">=</span> <span class="s1">&#39;Tokyo&#39;</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">active_record</span><span class="o">.</span><span class="n">default_timezone</span> <span class="o">=</span> <span class="ss">:local</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;日本語化&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="n">config</span><span class="o">.</span><span class="n">i18n</span><span class="o">.</span><span class="n">load_path</span> <span class="o">+=</span> <span class="no">Dir</span><span class="o">[</span><span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s1">&#39;config&#39;</span><span class="p">,</span> <span class="s1">&#39;locales&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;em&gt;*&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;/em&gt;.{rb,yml}&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_s</span><span class="o">]</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">i18n</span><span class="o">.</span><span class="n">default_locale</span> <span class="o">=</span> <span class="ss">:ja</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;generatorの設定&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="n">config</span><span class="o">.</span><span class="n">generators</span> <span class="k">do</span> <span class="o">|</span><span class="n">g</span><span class="o">|</span>
</span><span class='line'>  <span class="n">g</span><span class="o">.</span><span class="n">orm</span> <span class="ss">:active_record</span>
</span><span class='line'>  <span class="n">g</span><span class="o">.</span><span class="n">template_engine</span> <span class="ss">:haml</span>
</span><span class='line'>  <span class="c1"># scaffoldをgenerateするとDraperが自動で生成されます。</span>
</span><span class='line'>  <span class="c1"># モデルがないとエラーが発生する可能性があるので注意してください</span>
</span><span class='line'><span class="k">end</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;load original validator(オリジナルのバリデーターがある場合のみ)&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="n">config</span><span class="o">.</span><span class="n">autoload_paths</span> <span class="o">+=</span> <span class="sx">%W(</span><span class="si">#{</span><span class="n">config</span><span class="o">.</span><span class="n">root</span><span class="si">}</span><span class="sx">/lib/validators)</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;libファイルの自動読み込み&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="n">config</span><span class="o">.</span><span class="n">autoload_paths</span> <span class="o">+=</span> <span class="sx">%W(</span><span class="si">#{</span><span class="n">config</span><span class="o">.</span><span class="n">root</span><span class="si">}</span><span class="sx">/lib)</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">autoload_paths</span> <span class="o">+=</span> <span class="no">Dir</span><span class="o">[</span><span class="s2">&quot;</span><span class="si">#{</span><span class="n">config</span><span class="o">.</span><span class="n">root</span><span class="si">}</span><span class="s2">/lib/**/&quot;</span><span class="o">]</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>N+1問題の対策Gem Bulletの設定。<br/>
<code>config/environments/development.rb</code>の<code>AppName::Application.configure</code>内に以下を追記。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>config.after_initialize <span class="k">do</span>
</span><span class='line'><span class="k">  </span>Bullet.enable <span class="o">=</span> <span class="nb">true</span> <span class="c"># Bulletプラグインを有効</span>
</span><span class='line'>  Bullet.alert <span class="o">=</span> <span class="nb">true</span> <span class="c"># JavaScriptでの通知</span>
</span><span class='line'>  Bullet.bullet_logger <span class="o">=</span> <span class="nb">true</span> <span class="c"># log/bullet.logへの出力</span>
</span><span class='line'>  Bullet.console <span class="o">=</span> <span class="nb">true</span> <span class="c"># ブラウザのコンソールログに記録</span>
</span><span class='line'>  Bullet.rails_logger <span class="o">=</span> <span class="nb">true</span> <span class="c"># Railsログに出力</span>
</span><span class='line'>  Bullet.disable_browser_cache <span class="o">=</span> <span class="nb">true</span> <span class="c">#ブラウザキャッシュの無効化</span>
</span><span class='line'>end
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>DBの作成。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rake db:create <span class="nv">RAILES_ENV</span><span class="o">=</span>development
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Twitter Bootstrapのインストール。<code>application.html.haml</code>が作成されるので、<code>application.html.erb</code>を削除。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails g bootstrap:layout application fluid
</span><span class='line'>rails g bootstrap:install
</span><span class='line'>rm -rf app/views/layouts/application.html.erb
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>font-awesomeの設定を追加する。
<code>app/assets/stylesheets/application.css</code>に以下のコードを追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'> <span class="o">*=</span> <span class="nb">require</span> <span class="n">font</span><span class="o">-</span><span class="n">awesome</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Compassのインストール。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bundle <span class="nb">exec </span>compass init --syntax sass
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Sassy-buttonsのインストール。<code>No such framework: "sassy-buttons"</code>と言われる場合はスキップ。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bundle <span class="nb">exec </span>compass install sassy-buttons
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>続いてSASS(CSS)を書くための<code>base.css.sass</code>ファイルを作成。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails g sass:assets base
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><code>base.css.sass</code>に以下を追加して、zurui-design, compass, sassy-buttonsを使えるようにする。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>@import compass/utilities
</span><span class='line'>@import compass/css3
</span><span class='line'>@import sassy-buttons
</span><span class='line'>@import zurui-sass
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Railsの日本語化ファイルを設定する。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>wget https://raw.github.com/svenfuchs/rails-i18n/master/rails/locale/ja.yml -P config/locales/
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>rails_configの設定、設定用ファイルの生成。（利用方法は<a href="https://github.com/railsjedi/rails_config">railsjedi/rails_config | GitHub</a>）</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails g rails_config:install
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>simple formの初期設定(bootstrap対応)</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails g simple_form:install --bootstrap
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Apacheの場合は設定を行なって、ブラウザで表示を確認する。</p>

<h2>Powを使っている場合</h2>

<p>Powを使っている場合はPowへのリンクの作成。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>powder link
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>RVM環境でPowを使っている場合はプロジェクトの直下に<code>.powrc</code>を作成して以下を追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="k">if</span> <span class="o">[</span> -f <span class="s2">&quot;$rvm_path/scripts/rvm&quot;</span> <span class="o">]</span> &amp;amp;&amp;amp; <span class="o">[</span> -f <span class="s2">&quot;.rvmrc&quot;</span> <span class="o">]</span>; <span class="k">then</span>
</span><span class='line'><span class="k">  </span><span class="nb">source</span> <span class="s2">&quot;$rvm_path/scripts/rvm&quot;</span>
</span><span class='line'>  <span class="nb">source</span> <span class="s2">&quot;.rvmrc&quot;</span>
</span><span class='line'><span class="k">fi</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>表示を確認する。<code>powder open</code>を実行して、ブラウザで<code>http://test-app.dev/</code>を確認。</p>

<h2>scaffold表示まで</h2>

<p>scaffoldを追加の前に<code>public/index.html</code>を削除。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rm -rf public/index.html
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>scaffoldの作成してビューを追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">scaffold</span> <span class="n">product</span> <span class="nb">name</span> <span class="n">price</span><span class="ss">:integer</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><code>config/routes.rb</code>にて、ルートアクセス設定を追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">root</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="s2">&quot;products#index&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>DBのマイグレーション。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rake</span> <span class="n">db</span><span class="ss">:migrate</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>ブラウザでscaffordしたビューが見れることをブラウザで確認。</p>

<h2>補足: open-uriでSSLをつかえるようにする</h2>

<p>SSLエラー回避のために<code>config/initializers/bypass_ssl_verification_for_open_uri.rb</code>を作成して以下を追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;SSLエラー回避&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="nb">require</span> <span class="s1">&#39;openssl&#39;</span>
</span><span class='line'><span class="no">OpenSSL</span><span class="o">::</span><span class="no">SSL</span><span class="o">::</span><span class="no">VERIFY_PEER</span> <span class="o">=</span> <span class="no">OpenSSL</span><span class="o">::</span><span class="no">SSL</span><span class="o">::</span><span class="no">VERIFY_NONE</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>注意点として、この設定を行うと<code>bypass_ssl_verification_for_open_uri.rb:3: warning: already initialized constant VERIFY_PEER</code>という警告メッセージがでるようになりますが、気にしなくて良さそうです。</p>

<h2>補足: ブラウザCSSのリセット</h2>

<p>ブラウザにはデフォルトのCSSがセットされており、ブラウザによってデザインが変化する可能性があります。そこで、ブラウザのCSSをリセットしてくれるCSSが<a href="http://yuilibrary.com/yui/docs/cssreset/">YUI(Yahoo! User Interface Library)から提供</a>されています。<br/>
配布がUSのサーバだと思う(レスポンスが遅くなる)ので、プロジェクト側にcssファイルをダウンロード。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>wget http://yui.yahooapis.com/3.8.0/build/cssreset/cssreset-min.css -P app/assets/stylesheets/
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p><code>app/assets/stylesheets/application.css.less</code>に以下のコードを追加。<br/>
(このコードを追加する場合は<code>// = require_tree .</code>を削除して、cssを個別にインポートすること)</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="o">/&lt;</span><span class="nt">em</span><span class="o">&gt;</span> <span class="nt">1</span><span class="err">行目に置いて下さい</span>
</span><span class='line'> <span class="o">&lt;/</span><span class="nt">em</span><span class="o">&gt;=</span><span class="nt">require</span> <span class="nt">cssreset-min</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>関連記事</h2>

<p><strong><a href="/blog/guard-spork-rspec-tdd">RSpec/Spork/Guard/Growl/Rails 3.2.9で作る - プリチーなTDD環境！</a></strong> : モダンなTDD環境を構築して、ハッピーなテストライフをエンジョイしましょぃ！</p>

<p><a href="/blog/capistrano-git-rails-deploy/">Rals3.2.9で始める Git連携Capistranoによる自動デプロイ</a> : サーバへのデプロイのプロセスにCapistranoを導入する手順です。</p>

<p><strong><a href="/blog/meta-tags-sitemap-generator-rails-seo">meta-tagsとsitemap_generatorで始めるRails 3.2のSEO対策</a></strong> : Railsのお手軽SEO対策にレッツトライ。</p>

<p><strong><a href="/blog/kaminari-gem-paginator-rails/">Railsの人気ページネーター Kaminariはbootstrap/hamlでも超簡単に導入可能</a></strong> : ページネーター導入の際は是非。</p>

<p><strong><a href="/blog/pow-guard-rails">開発サーバをThinからPowに切り替えて開発効率アップ！ (Mac限定)</a></strong> にてPowに関する記事を載せました。サーバPowインストールがまだの方はぜひ。</p>

<h2>Special Thanks</h2>

<ul>
<li><p><a href="http://d.hatena.ne.jp/hrsth/20110616/1308229846">rvm のgemsetをおさらい（Mac でRuby） - たぐってつづる</a></p></li>
<li><p><a href="http://naoty.hatenablog.com/entry/2012/05/20/032251">Rails開発環境 2012初夏</a></p></li>
<li><p><a href="http://d.hatena.ne.jp/hnw/20121221">.gitignoreを作ってくれるgiboが便利すぎる - hnwの日記</a></p></li>
<li><p><a href="http://ishikawa.r-stone.net/2011/02/rails-3-opensslsslsslerror.html">守破離でいこう!!: Rails 3 で OpenSSL::SSL::SSLError</a></p></li>
</ul>


<h2>変更来歴</h2>

<p>11/26 12:00 Thinサーバに関する記述を追加<br/>
11/26 14:00 Guardに関する記述を追加/Gemを見直し<br/>
11/28 16:40 Dev/Test環境のサーバをPowに変更<br/>
11/29 09:40 Foremanを削除、TDD関連の構築手順を別記事に<br/>
12/03 10:00 Gemfileにyardを追加<br/>
12/03 22:10 RSpec/FactoryGirlに関する情報をTDD記事に移動<br/>
12/05 12:25 定数管理のGem rails_configを追加<br/>
12/06 10:30 Gemfileにrakeを追加(本番でrake実行時必要だったため)<br/>
12/13 12:35 Gemfileにbetter_errorsを追加<br/>
12/19 14:50 記事のレイアウトを修正<br/>
12/21 18:30 Gemfileに「gem 'libv8', '~> 3.11.8'」を追加<br/>
12/23 23:40 RVM/POWを使う場合の設定を追加<br/>
12/24 17:15 .rvmrcにgemsetの記述を追加<br/>
12/25 09:35 gemsetに関する記述を削除<br/>
12/27 09:40 .giboに関する記述を追加、MySQLの記述を削除<br/>
12/27 11:00 リセットCSSに関する記述を追加<br/>
12/27 17:05 Gemfileにrails-footnotes/quiet_assetsを追加<br/>
01/01 20:45 Gemfileにfont-awesome-railsを追加<br/>
01/02 10:25 SSLエラー回避の対策にenvironment.rbに記述<br/>
01/02 12:00 draper => active_decoratorに浮気<br/>
01/09 11:05 public/index.htmlを削除するように修正<br/>
01/09 11:35 Gem therubyracer', libv8'のバージョン変更<br/>
01/22 14:10 Gem Bulletの設定が抜けていたので追加<br/>
01/28 10:55 application.rb内のlocaleファイルの読み込み方法を変更<br/>
01/28 11:15 補足: open-uriでSSLをつかえるようにするを編集して作成<br/>
02/06 19:05 Bulletの設定についての記述を微調整<br/>
02/08 16:25 BootstrapのGemを変更、compress, sassy-buttons, zurui-design-railsを使うプロセスに変更<br/>
05/16 21:25 Rails 3.2.13環境</p>

<h2>テスト環境</h2>

<p>テスト環境は以下の通りです。</p>

<pre>
OS : Mac Mountain Lion(OS X 10.8)
Ruby : 1.9.3-p327
Rails : 3.2.13
haml : 3.1.7
coffee-script : 3.2.1
Rspec : 2.12.0
</pre>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[HerokuにRails 3.2.9/Bootstrapでデプロイ 最短・簡単ガイドだよ！]]></title>
    <link href="http://morizyun.github.io/blog/heroku-rails-postgresql/"/>
    <updated>2012-11-25T14:00:00+09:00</updated>
    <id>http://morizyun.github.io/blog/heroku-rails-postgresql</id>
    <content type="html"><![CDATA[<p>Heroku + Rails 3.2.9 + Bootstrap + Haml + PostgreSQL でデプロイするまでの最短ガイドを作りました！</p>

<p><a href="http://morizyun.github.io/blog/heroku-rails-postgresql" title="fpu_tmp_1353848330.5039_237fab by morizyun, on Flickr"><img src="http://farm9.staticflickr.com/8066/8216074991_1f11f3eda7_z.jpg" width="640" height="234" alt="fpu_tmp_1353848330.5039_237fab"></a></p>

<!-- more -->


<h2>Heroku ユーザー登録</h2>

<p><a href="http://heroku.com">Heroku</a>でユーザー登録をします。
アカウント作成時に使ったメールアドレスとパスワードは後で使うのでメモっておいてください。</p>

<p><a href="http://heroku.com/" title="fpu_tmp_1353828845.2153_57ac05 by morizyun, on Flickr"><img src="http://farm9.staticflickr.com/8482/8216564804_23e4f2f0e6.jpg" width="500" height="233" alt="fpu_tmp_1353828845.2153_57ac05"></a></p>

<p><a href="https://toolbelt.heroku.com/">Heroku Toolbelt</a>をインストールします。Heroku Toolbeltの機能は；</p>

<ul>
<li>Heroku client - Heroku appsを管理するためのCLI</li>
<li>Foreman - ローカルでHerokuアップを動かすためのオプション</li>
<li>Git - HerokuへのPush/ソースのバージョン管理</li>
</ul>


<p><a href="https://toolbelt.heroku.com/" title="fpu_tmp_1353829261.6919_09c68e by morizyun, on Flickr"><img src="http://farm9.staticflickr.com/8206/8216575530_03e6a52a70.jpg" width="500" height="291" alt="fpu_tmp_1353829261.6919_09c68e"></a></p>

<h2>ローカル環境設定</h2>

<p>任意でrailsのアップデートを実行します。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rvmsudo gem update rails
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>gem herokuをインストールします。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>gem install <span class="s1">&#39;heroku&#39;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>アカウント作成時に使ったメールアドレスとパスワードを事前に設定します。
これによってデプロイのたびに、パスワードを聞かれるのを防ぎます。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">heroku</span> <span class="n">keys</span><span class="ss">:add</span>
</span><span class='line'><span class="no">Enter</span> <span class="n">your</span> <span class="no">Heroku</span> <span class="n">credentials</span><span class="o">.</span>
</span><span class='line'><span class="no">Email</span><span class="p">:</span> <span class="n">email</span><span class="vi">@example</span><span class="o">.</span><span class="n">com</span>
</span><span class='line'><span class="no">Password</span><span class="p">:</span> <span class="n">your</span><span class="o">-</span><span class="n">password</span>
</span><span class='line'><span class="no">Uploading</span> <span class="n">ssh</span> <span class="kp">public</span> <span class="n">key</span> <span class="sr">/Users/</span><span class="n">joe</span><span class="o">/.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="o">.</span><span class="n">pub</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>Rails プロジェクト作成 〜 index.html表示まで</h2>

<p>Railsの新規プロジェクトを作成します。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails new <span class="nb">test</span>-app --skip-test-unit -d postgresql
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Gitリポジトリ作成を作成します。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>git init
</span><span class='line'>git add -A
</span><span class='line'>git commit -m <span class="s2">&quot;create new project&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>herokuコマンドを使って、heroku上にアプリケーションを作成します。
(test-appだとすでに使われてて動かないので、使われてなさそうな名前がいいっすよ〜)</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>heroku create <span class="nb">test</span>-app --stack cedar&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;blockquote&gt;&lt;p&gt;Creating <span class="nb">test</span>-app... <span class="k">done</span>, stack is cedar
</span><span class='line'>http://test-app.herokuapp.com/ | git@heroku.com:test-app.git
</span><span class='line'>Git remote heroku added <span class="c"># &amp;lt;= こうなっていれば成功</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p></blockquote>

<p>http://test-app.herokuapp.com/ をブラウザで表示されることを確認。</p>

<h2>Rails Gem登録 〜 scaffold表示まで</h2>

<p>gemfileを編集して、プロジェクトに任意のGemを追加。
(gemは適宜カスタマイズしてください)</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>gemfile  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">source</span> <span class="s1">&#39;https://rubygems.org&#39;</span>
</span><span class='line'>ruby <span class="s2">&quot;1.9.3&quot;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;rails&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Bootstrap&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;less-rails&#39;</span>
</span><span class='line'>gem <span class="s1">&#39;less-rails-bootstrap&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Form Builders&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;simple_form&#39;</span>
</span><span class='line'>gem <span class="s1">&#39;country_select&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Haml&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;haml-rails&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;jQuery/json&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;jquery-rails&#39;</span>
</span><span class='line'>gem <span class="s1">&#39;jquery-cookie-rails&#39;</span> <span class="c"># jquery-cookie</span>
</span><span class='line'>gem <span class="s1">&#39;json&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Presenter&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;draper&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Thin&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;gem <span class="s1">&#39;thin&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;group :assets <span class="k">do</span>
</span><span class='line'><span class="k">  </span>gem <span class="s1">&#39;coffee-rails&#39;</span>
</span><span class='line'>  gem <span class="s1">&#39;therubyracer&#39;</span>
</span><span class='line'>  gem <span class="s1">&#39;uglifier&#39;</span>
</span><span class='line'>end&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;group :development <span class="k">do</span>
</span><span class='line'>  <span class="c"># 環境変数をロードして複数のプロセスを実行する作業を自動化</span>
</span><span class='line'>  gem <span class="s1">&#39;foreman&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># viewやcssの変更を監視してブラウザを自動的にリロードする</span>
</span><span class='line'>  gem <span class="s1">&#39;guard-livereload&#39;</span>
</span><span class='line'>  gem <span class="s1">&#39;em-websocket&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># デバッガー</span>
</span><span class='line'>  gem <span class="s1">&#39;pry-rails&#39;</span>
</span><span class='line'>end&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;group :development, :test <span class="k">do</span>
</span><span class='line'><span class="k">  </span>gem <span class="s1">&#39;mysql2&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># Rspec</span>
</span><span class='line'>  gem <span class="s1">&#39;rspec-rails&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># FactoryGirl</span>
</span><span class='line'>  gem <span class="s1">&#39;factory_girl_rails&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># 設定をロードしたサーバーによってテストを高速化</span>
</span><span class='line'>  gem <span class="s1">&#39;spork&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># ファイルの変更を検知する。OSX用</span>
</span><span class='line'>  gem <span class="s1">&#39;rb-fsevent&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># テスト結果をGrowlで通知する</span>
</span><span class='line'>  gem <span class="s1">&#39;growl&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># ファイルの変更を監視してテストを自動化</span>
</span><span class='line'>  gem <span class="s1">&#39;guard-rspec&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="c"># 設定ファイルの変更を監視してテストサーバーを再起動</span>
</span><span class='line'>  gem <span class="s1">&#39;guard-spork&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  gem <span class="s1">&#39;rails3-generators&#39;</span>, :git <span class="o">=</span>&gt; <span class="s1">&#39;https://github.com/neocoin/rails3-generators.git&#39;</span>
</span><span class='line'>end&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;group :postgres <span class="k">do</span>
</span><span class='line'><span class="k">  </span>gem <span class="s1">&#39;pg&#39;</span>
</span><span class='line'>end
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Gemをインストール。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bundle install
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>config/application.rbの設定です。<br/>(class Application &lt; Rails::Application内に追記してください)</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>config/application.rb  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;LESS&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="n">config</span><span class="o">.</span><span class="n">app_generators</span><span class="o">.</span><span class="n">stylesheet_engine</span> <span class="ss">:less</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">less</span><span class="o">.</span><span class="n">paths</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="si">}</span><span class="s2">/lib/less/protractor/stylesheets&quot;</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">less</span><span class="o">.</span><span class="n">compress</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">compress</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">assets</span><span class="o">.</span><span class="n">initialize_on_precompile</span><span class="o">=</span><span class="kp">false</span> <span class="c1"># herokuでasset:precomileエラー対策&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="no">Set</span> <span class="n">timezone</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;config.time_zone = &#39;Tokyo&#39;</span>
</span><span class='line'><span class="sr">config.active_record.default_timezone = :local&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="err">日本語化</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;config.i18n.default_locale = :ja&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">generator</span><span class="err">の設定</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;config.generators do |g|</span>
</span><span class='line'><span class="sr">  g.orm :active_record</span>
</span><span class='line'><span class="sr">  g.template_engine :haml</span>
</span><span class='line'><span class="sr">  g.test_framework  :rspec, :fixture =&gt; true</span>
</span><span class='line'><span class="sr">  g.fixture_replacement :factory_girl, :dir =&gt; &quot;spec/</span><span class="n">factories</span><span class="s2">&quot;</span>
</span><span class='line'><span class="s2">end&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;h1&gt;load original validator(オリジナルのバリデーターがある場合のみ)&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;config.autoload_paths += %W(</span><span class="si">#{</span><span class="n">config</span><span class="o">.</span><span class="n">root</span><span class="si">}</span><span class="s2">/lib/validators)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Herokuのタイムゾーン設定。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>heroku config:add <span class="nv">TZ</span><span class="o">=</span>Asia/Tokyo
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>application.cssを削除して、lessファイルを生成</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='css'><span class='line'><span class="nt">rm</span> <span class="nt">-rf</span> <span class="nt">app</span><span class="o">/</span><span class="nt">assets</span><span class="o">/</span><span class="nt">stylesheets</span><span class="o">/</span><span class="nt">application</span><span class="nc">.css</span>
</span><span class='line'><span class="nt">rails</span> <span class="nt">generate</span> <span class="nt">less</span><span class="nd">:assets</span> <span class="nt">application</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>bootstrapのcssを読み込むように設定を追加する。
app/assets/stylesheets/application.css.lessに以下んコードを追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/assets/stylesheets/application.css.less  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="sr">//</span> <span class="o">=</span> <span class="n">require_tree</span> <span class="o">.</span>
</span><span class='line'><span class="vi">@import</span> <span class="s2">&quot;twitter/bootstrap&quot;</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>bootstrapのjavascriptを読み込むようにするために、app/assets/javascripts/application.jsに以下のコードを追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/assets/javascripts/application.js  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="sr">//</span><span class="o">=</span> <span class="nb">require</span> <span class="n">twitter</span><span class="o">/</span><span class="n">bootstrap</span>
</span><span class='line'><span class="sr">//</span><span class="o">=</span> <span class="nb">require</span> <span class="n">jquery</span><span class="o">.</span><span class="n">cookie</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;$(document).ready(function(){&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="p">});</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>application.html.erbファイルをhamlにファイル名を変更。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mv app/views/layouts/application.html.erb app/views/layouts/application.html.haml
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>application.html.hamlの中身もhaml形式にする。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>application.html.haml  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="nn">!!! 5</span>
</span><span class='line'><span class="nt">%html</span>
</span><span class='line'>  <span class="nt">%head</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;%title TEST_APP
</span><span class='line'><span class="p">=</span> <span class="n">stylesheet_link_tag</span> <span class="s2">&quot;application&quot;</span><span class="p">,</span> <span class="ss">:media</span> <span class="o">=&amp;</span><span class="n">gt</span><span class="p">;</span> <span class="s2">&quot;all&quot;</span>
</span><span class='line'><span class="p">=</span> <span class="n">javascript_include_tag</span> <span class="s2">&quot;application&quot;</span>
</span><span class='line'><span class="p">=</span> <span class="n">csrf_meta_tags</span>
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  %body&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;= yield
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Railsの日本語化ファイルを設定する。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>wget https://raw.github.com/svenfuchs/rails-i18n/master/rails/locale/ja.yml
</span><span class='line'>mv ja.yml config/locales/ja.yml
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>simple formの初期設定(bootstrap対応)</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails generate simple_form:install --bootstrap
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>railsへのrspecのインストールと雛形を作成</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails generate rspec:install
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>rspecの設定ファイル"spec/spec_helper.rb"を修正(コメントアウトする)</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>spec/spec_helper.rb  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;config.fixture_path = &quot;</span><span class="si">#{</span><span class="o">::</span><span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="si">}</span><span class="sr">/s</span><span class="n">pec</span><span class="o">/</span><span class="n">fixtures</span><span class="s2">&quot;&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;h1&gt;config.use_transactional_fixtures = true&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>scaffoldを追加の前にpublic/index.htmlをリネーム(無効化する)。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mv public/index.html public/_____index.html
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>scaffoldの作成してビューを追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">scaffold</span> <span class="n">product</span> <span class="nb">name</span> <span class="n">price</span><span class="ss">:integer</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>config/routes.rbにて、ルートアクセス設定を追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>config/routes.rb  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">root</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="s2">&quot;products#index&quot;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Herokuでthinが動くようにする。
プロジェクト直下にProcfileを新規作成。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>Procfile  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>web: bundle <span class="nb">exec </span>rails server thin -p <span class="nv">$PORT</span> -e <span class="nv">$RACK_ENV</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>設定画反映されたかチェック。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>foreman check&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;blockquote&gt;&lt;p&gt;valid procfile detected <span class="o">(</span>web<span class="o">)</span> ← 成功
</span></code></pre></td></tr></table></div></figure></notextile></div></p></blockquote>

<p>$RACK_ENVをセットするファイルを作成
<div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">echo</span> <span class="s2">&quot;RACK_ENV=development&quot;</span> &gt;&gt;.env
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>gitに.envが記録されないようにする。
プロジェクト直下の.gitignoreに以下を追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>.gitignore  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>.env
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>Herokuへのアプリのデプロイ => DBのマイグレーション。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">git</span> <span class="n">add</span> <span class="o">.</span> <span class="o">-</span><span class="n">A</span>
</span><span class='line'><span class="n">git</span> <span class="n">commit</span> <span class="o">-</span><span class="n">m</span> <span class="s2">&quot;add scafford&quot;</span>
</span><span class='line'><span class="n">git</span> <span class="n">push</span> <span class="n">heroku</span> <span class="n">master</span>
</span><span class='line'><span class="n">heroku</span> <span class="n">run</span> <span class="n">rake</span> <span class="n">db</span><span class="ss">:migrate</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>ブラウザでscaffordしたビューが見れることを確認。
デプロイまでの最短ガイドは以上っす。</p>

<p>Thank very much you for your kind attention.</p>

<h2>関連記事</h2>

<p><strong><a href="/blog/pow-guard-rails">開発サーバをThinからPowに切り替えて開発効率アップ！ (Mac限定)</a></strong> にてPowに関する記事を載せました。Guardが更に活用できると思います。よかったらぜひ見てください。</p>

<h2>補足 : ローカルでのテスト環境の構築</h2>

<p>config/database.ymlを以下の通り編集する。今回は</p>

<ul>
<li>"development", "test" => mysql</li>
<li>"production" => postgreSQL</li>
</ul>


<p>とした場合の設定です。環境に合わせて調整を。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>config/database.yml  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">development</span><span class="p">:</span>
</span><span class='line'>  <span class="n">adapter</span><span class="p">:</span> <span class="n">mysql2</span>
</span><span class='line'>  <span class="n">encoding</span><span class="p">:</span> <span class="n">utf8</span>
</span><span class='line'>  <span class="n">reconnect</span><span class="p">:</span> <span class="kp">false</span>
</span><span class='line'>  <span class="n">database</span><span class="p">:</span> <span class="nb">test</span><span class="o">-</span><span class="n">app_development</span>
</span><span class='line'>  <span class="n">pool</span><span class="p">:</span> <span class="mi">5</span>
</span><span class='line'>  <span class="n">username</span><span class="p">:</span> <span class="n">root</span>
</span><span class='line'>  <span class="n">password</span><span class="p">:</span>
</span><span class='line'>  <span class="n">socket</span><span class="p">:</span> <span class="sr">/var/</span><span class="n">lib</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">mysql</span><span class="o">.</span><span class="n">sock</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;test:</span>
</span><span class='line'><span class="sr">  adapter: mysql2</span>
</span><span class='line'><span class="sr">  encoding: utf8</span>
</span><span class='line'><span class="sr">  reconnect: false</span>
</span><span class='line'><span class="sr">  database: test-app_test</span>
</span><span class='line'><span class="sr">  pool: 5</span>
</span><span class='line'><span class="sr">  username: root</span>
</span><span class='line'><span class="sr">  password:</span>
</span><span class='line'><span class="sr">  socket: /</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">mysql</span><span class="o">.</span><span class="n">sock</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;production:</span>
</span><span class='line'><span class="sr">  adapter: postgresql</span>
</span><span class='line'><span class="sr">  encoding: unicode</span>
</span><span class='line'><span class="sr">  database: test-app_production</span>
</span><span class='line'><span class="sr">  pool: 5</span>
</span><span class='line'><span class="sr">  username:</span>
</span><span class='line'><span class="sr">  password:</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>DBの作成を実行。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rake db:create <span class="nv">RAILES_ENV</span><span class="o">=</span><span class="s1">&#39;development&#39;</span>
</span><span class='line'>rake db:create <span class="nv">RAILES_ENV</span><span class="o">=</span><span class="s1">&#39;test&#39;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>サーバプロセスを起動する。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>foreman start
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>http://0.0.0.0:5000/_____index.htmlを表示してDBに接続されていることを確認する。</p>

<h2>補足 : コマンド系</h2>

<p>Heroku コマンド一覧</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;herokuへのログイン&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku login
</span><span class='line'>Email: email@example.com
</span><span class='line'>Password: your-password&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;アプリの作成&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku create&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;マイグレーション&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku run rake db:migrate&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;アプリのデプロイ&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;git add . -A
</span><span class='line'>git commit -m <span class="s2">&quot;add function&quot;</span>
</span><span class='line'>git push heroku master&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;環境変数のセット&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku config:add <span class="nv">USERNAME</span><span class="o">=</span>admin <span class="nv">PASSWORD</span><span class="o">=</span>xxx&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;ログ確認&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku logs -t&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;heroku プロセス情報の表示&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku ps&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;heroku 環境変数の表示&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;heroku config
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>既存モデルのRspec雛形を作成するコマンド。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>rails generate rspec:model products
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>テスト環境は以下の通りです。</p>

<pre>
OS : Mac Lion(OS X 10.7)
Rails : 3.2.9
haml : 3.1.7
coffee-script : 3.2.1
</pre>


<h2>Special Thanks</h2>

<ul>
<li><p><a href="http://nobyu.hatenadiary.jp/entry/20100207/1265531331">HerokuとRailsで手早くWebサイトを作る</a></p></li>
<li><p><a href="http://change-the-world.heroku.com/5">Railsアプリ作成 + Herokuデプロイ</a></p></li>
<li><p><a href="http://ovreneli.blogspot.jp/2012/06/railspostgresqlheroku.html">RailsアプリをPostgreSQLで開発してHerokuにデプロイするまでの簡単まとめ</a></p></li>
<li><p><a href="http://edywrite.blogspot.jp/2012/08/herokuwebthin.html">Herokuのwebサーバをthinに変更する</a></p></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[zClip(zeroClipBoard)をRails/Coffeescriptに組み込む]]></title>
    <link href="http://morizyun.github.io/blog/zclip-zeroclipboard-jquery-rails-coffeescript/"/>
    <updated>2012-11-20T15:00:00+09:00</updated>
    <id>http://morizyun.github.io/blog/zclip-zeroclipboard-jquery-rails-coffeescript</id>
    <content type="html"><![CDATA[<p><a href="http://morizyun.github.io/blog/zclip-zeroclipboard-jquery-rails-coffeescript" title="fpu_tmp_1353859887.4897_48b374 by morizyun, on Flickr"><img src="http://farm9.staticflickr.com/8341/8216611031_5f095c2056_n.jpg" width="320" height="155" alt="fpu_tmp_1353859887.4897_48b374"></a></p>

<p>「Webサイト内のデータをローカルPCのクリップボード貼付ける」という機能は <a href="http://www.steamdev.com/zclip/">jQuery PluginのjQuery ZeroClipboard</a> とflash(swf)を使うのがメジャーなやり方のようです。</p>

<p>今回は、ZeroClipboardをRails/CoffeeScript/hamlに組み込むサンプルを載せておきます。</p>

<p><a href="http://zclip-heroku.herokuapp.com/" class="button big primary">Demo</a>
<a href="https://github.com/morizyun/zclip-heroku" class="button big primary">Source(GitHub)</a></p>

<!-- more -->


<h2>(1) jQuery ZeroClipboardからファイルをダウンロード</h2>

<p><a href="http://www.steamdev.com/zclip/">jQuery ZeroClipboard</a>からjquery pluginとswfファイルをダウンロード。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>コンソール  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nb">cd </span>app/assets/javascripts/
</span><span class='line'>wget http://www.steamdev.com/zclip/js/jquery.zclip.min.js
</span><span class='line'><span class="nb">cd </span>app/app/assets/images/
</span><span class='line'>wget http://zeroclipboard.googlecode.com/svn-history/r10/trunk/ZeroClipboard.swf
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>(2) jQuery ZeroClipboardのjsファイルの読込設定</h2>

<p>application.jsに以下を追記して、jquery.zclip.min.jsを読み込むようにする。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/assets/javascripts/application.js  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="sr">//</span><span class="o">=</span> <span class="nb">require</span> <span class="n">jquery</span>
</span><span class='line'><span class="sr">//</span><span class="o">=</span> <span class="nb">require</span> <span class="n">jquery</span><span class="o">.</span><span class="n">zclip</span><span class="o">.</span><span class="n">min</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>(3) viewファイルにペーストするデータとボタンを表示</h2>

<p>viewファイルに貼り付けるコードを表示するフォーム(任意)と、貼り付けボタンを追加。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>viewファイル  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='haml'><span class='line'><span class="nt">%textarea</span><span class="nf">#paste_item</span><span class="p">=</span> <span class="vi">@paste_item</span> <span class="o">-</span><span class="c1">#ここに任意のデータを載せる</span>
</span><span class='line'><span class="nt">%button</span><span class="nf">#set_clipboard</span> クリップボードに貼付ける
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>(4) viewファイルにペーストするデータとボタンを表示</h2>

<p>ボタンを押すとtextareaからクリップボードにコピーされるように、
coffeescriptに以下を追記。</p>

<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>coffeescriptファイル  </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="err">$</span> <span class="o">-&gt;</span>
</span><span class='line'>  <span class="c1"># ボタンを押したら、textareaからクリップボードにデータをコピーする</span>
</span><span class='line'>  <span class="err">$</span><span class="p">(</span><span class="s2">&quot;button#set_clipboard&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">zclip</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;pre&gt;&lt;code&gt;path: &quot;/</span><span class="n">assets</span><span class="o">/</span><span class="no">ZeroClipboard</span><span class="o">.</span><span class="n">swf</span><span class="s2">&quot;</span>
</span><span class='line'><span class="s2">copy: -&amp;gt;</span>
</span><span class='line'><span class="s2">  $(&quot;</span><span class="n">textarea</span><span class="c1">#paste_item&quot;).html()</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/code&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<h2>参考サイト</h2>

<p><a href="http://blog.h2o-space.com/post/11911481382" target="_blank">Webページ上からクリップボードにコピーできる『zClip』</a></p>

<h2>テスト環境</h2>

<pre>
# Rails : 3.2.9
# haml : 3.1.7
# coffee-script : 3.2.1
</pre>

]]></content>
  </entry>
  
</feed>
